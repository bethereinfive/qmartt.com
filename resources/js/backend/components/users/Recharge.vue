<template>
    <div>


        <div data-v-c11b5104="" class="container">
                <div data-v-890639a6="" data-v-c11b5104="" class="title-bar wrap" style="background: linear-gradient(var(--button1) 100%, var(--button2) 0%);">
                    <span data-v-890639a6="" class="back">
                        <img
                            data-v-890639a6=""
                            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAoCAMAAAC/1ZhiAAABDlBMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8v3yHCAAAAWXRSTlMAAgMFBggJCwwPEBITFRYaICEnKy0xNDY6Oz1DSElSWFpbYWVpcHJzdnp8fYGCiIyTlp2fp6+ws7e4vsDFyMzP0dLT1dfb3OPk6Ons7/Hy8/T19/n6+/z9/poeTkQAAADoSURBVBgZ3cHZIkIBFAXQXbiS4eZGKJnLPCdDEhIlUyF3//+P2H9wzosXa+GfSJ/3zgJ4TNyS3IRD2KSUYcs8Uq4DmKInytUoTDMdysUITLkupToE08IrpZKEqfBBOU3AVOxTjmFb+qIcwrY6oOzDtv5DMi7DVopJxhuw7VIGa7DtUL6X4fBOWYHHHaWWgkP2mVIfg0PUptyMwyHTotxPwSFsUh5COEw2KK1pOKTrlHYEh1SN0snCIbikdGfhMFylvMzBIVmhvOXhkDih9ArwOKL0i/A4oHzm4LFN2YNLieQifOa38vhrv41dP5FpuPPwAAAAAElFTkSuQmCC"
                            alt=""
                        />
                    </span>
                    <p data-v-890639a6="" class="title">Top up</p>
                    <span data-v-890639a6="" class="right-top-btn">
                        <span data-v-890639a6=""></span>
                        <img
                            data-v-890639a6=""
                            src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAoCAYAAACIC2hQAAAAAXNSR0IArs4c6QAABBRJREFUWEftmGnIlVUUhZ9FVFDRAA2UFUbQgBWNEEUzNGBlNoiShPWnhNQIqSgkgyKMgiZSoh/NJRFYkNL0L4rAwgjLImgUJBrJRooVS857uff1Tt/97isY7T8f3z17n3edtffZe58tthPRdoKT/wZQ20cCuzbI+l/ABkn521d6Mmr7WeAyYKdBm0xi/R/gTWCmpN/67dMVqO0jgA8aBtmOa4akl0cBejzwXjF8EXh7Eqz1Mj0amFcW50p6ZrJAF0u6b9xAbV8JPP0/0HEx2xijtnPxZgH7jQB2o6TEekuaBHorcNcIICuThZIeqv5pEug1wApgxxHA/g3kZq9sHGg+YPvkEV3/taT3t4nrR2Cxr0mTrj8GeG4IRv8AHpO0tB/SJoHeDywaktnvgEMkbe6lb/sioCqbF0p6ZSyVyfZUYDlwwACwYXS5pMcHHcr2PUXnZkkeC9BBH216vVf31N6UtGq97YuBvWugNklaPQio7Xgi/W3sExKfSfpkkF21PjRQ2zcBy7psnJ5ynqSqwehQsX05cANwHLBL22Ka5a9KOK0YtR/dilHb1wEPAzvUwOaDsyS9VMuT+wKJ03O72NTPuwGYLSk9cFcZmtGS8M8A9qntlGT+bg1k3BzgJ5bf073nVr8B/ADsBaQfvQQ4qOjkEp5Z32vCrh82lmzn6bIGOLvYJH7nS4qb62GxO7AEWADsDCStnSTpi7ruhBgdBqzthcADRXeVpJmVne1pQBqTFIS8ybaI7VuAO0uIdNg0wqjtsPIpcDDwLXCYpJ/bAAXcnLI2RVKalQpsvHA+kBA4td4bjJVR2+cArxZmlkgKSy2xvQqYAfyUUtz+TLZ9FvB6sV0q6Y5223EDvRGo3ldhpeNROABovLEJ2BNYLWl6k0CTZ5Nv4+5pkjbWGK1c/0tx74e19Y+BPNXXSzqqSaBx9W3A7wXo5zUgc0tuTS7+BjhP0kdtcfplie91klIgWjJu188HHim7B8Rr9Uxh+95SqSqwpyUd2d4DyMGSY1dKmt0k0CTxDC7yXHlU0rXdUprtxHFaxoBdJOlB21cBTxT9BZJSBZthtOTEtcAJwJ/AsZJSHrcS20ny0bseSJpaBxxewmaqpKS3CQHNhejZAGcaB1wt6ccC9IJSPsPqemC6pMReV7EdveeBS4vCMkkpAB3SK0anAAnylLhhpMNVthOniddISmcu2AuSwnJLbJ8O3A2cUn58J6VXUpL+YKCFmZzw9iHmo6nLV1SMVrvbfqpUocRhWsHU8beA6GeIEXAHtk0ME9u5gN93Y6bRibPtxeWwu/VxS9rETPIyoOgZYo0CLZ7ZH8jwIh46FLaM4/M+ShlNK/ikpGrE2fM8jQOtxWRawOTJzZJ+HSb4K51tCnQiwOq6/wLGrxJH9mwckwAAAABJRU5ErkJggg=="
                            alt=""
                        />
                    </span>
                </div>

                <div data-v-c11b5104="">




                    <div data-v-c11b5104="" id="recharge">
                        <div data-v-c11b5104="" class="amount">

                        <div class="form-group" style="    margin-bottom: 25px;">
                            <label for="" class="title">Recharge Method</label>
                            <select class="form-control" v-model="payMethods" @change="getMethods"  required>
                                <option value="">Select</option>
                                <option v-for="pay in row" :key="'pay' + pay.id" :value="pay.id">{{ pay.name }}
                                    </option>
                            </select>
                        </div>



                        <div data-v-c11b5104="" class="rules" style="margin-bottom:20px" v-if="copyMessage">
                            <p data-v-c11b5104="" class="title">Instruction for Recharge</p>

                            <ul class="list-unstyled">
                                <li class="li"><span>{{ form.method }} Account</span><span>
                                    {{ copyMessage }}  <i @click="copyref" class="far fa-copy"></i>
                                    <br>
                                    <img style="width:200px; height: 200px !important;"  v-if="form.method=='USDT (TRC-20)'" :src="$asseturl+'frontend/img/qrcode.jpeg'" alt="">
                                    </span>
                                </li>
                            </ul>

                            <div data-v-c11b5104="" class="content"><p data-v-c11b5104="">If you encounter any problems while trying to Recharge, please contact the online customer service</p></div>
                        </div>





                            <p data-v-c11b5104="" class="title">Recharge amount</p>
                            <div data-v-c11b5104="" class="input-block">
                                <input data-v-c11b5104="" type="text" placeholder="Please enter the amount to top up" v-model="amount" class="" />
                                <div data-v-c11b5104="" class="after">৳</div>
                            </div>




                            <div class="form-group">
                                <label for="">Sender Number</label>
                                <input type="tel" class="form-control" placeholder="Please enter Sender Number"  v-model="form.sender" required >
                            </div>

                            <div class="form-group mb-3">
                                <label for="">Transition Id</label>
                                <input type="text" class="form-control" placeholder="Please enter Transition Id"  v-model="form.trx" required>
                            </div>

                        </div>



                        <div data-v-c11b5104="" class="rechargrBtn" @click="onSubmit">Top up</div>
                        <div data-v-c11b5104=""><!----></div>

                    </div>
                </div>


            </div>


            <div class="copyPopup" v-if="popup">
                <span> Number copied success</span>
            </div>






<!--
        <section id="topbar">
            <div class="title">
                <a href="javascript:void(0)" @click="$router.go(-1)"><i class="fa fa-angle-left"></i></a>
                <p>Recharge</p>
            </div>
        </section>

        <section id="reclist">
            <div class="details">
                <div class="container-fluid">
                    <div v-if="step == 1">


                        <div class="form-group">
                            <label for="">Recharge Method</label>
                            <select class="form-control" v-model="payMethods" @change="getMethods"  required>
                                <option value="">Select</option>
                                <option v-for="pay in row" :key="'pay' + pay.id" :value="pay.id">{{ pay.name }}
                                    </option>
                            </select>
                        </div>


                        <div class="form-group">
                            <label for="">Recharge Amount</label>
                            <input type="tel" class="form-control" v-model="amount" >
                        </div>

                        <div class="row" v-if="payMethods && form.method=='USDT'">

                            <div class="col-6 amount_item" @click="amount = 10"><span>{{ 10 }} USD</span> </div>
                            <div class="col-6 amount_item" @click="amount = 20"><span>{{ 20 }} USD</span></div>
                            <div class="col-6 amount_item" @click="amount = 50"><span>{{ 50 }} USD</span></div>
                            <div class="col-6 amount_item" @click="amount = 100"><span>{{ 100 }} USD</span></div>
                            <div class="col-6 amount_item" @click="amount = 200"><span>{{ 200 }} USD</span></div>
                            <div class="col-6 amount_item" @click="amount = 500"><span>{{ 500 }} USD</span></div>


                        </div>


                        <div class="row" v-else-if="payMethods">
                            <div class="col-6 amount_item" @click="amount = 700"><span>{{ 700/rates }}</span> </div>
                            <div class="col-6 amount_item" @click="amount = 1000"><span>{{ 1000/rates }}</span></div>
                            <div class="col-6 amount_item" @click="amount = 2000"><span>{{ 2000/rates }}</span></div>
                            <div class="col-6 amount_item" @click="amount = 5000"><span>{{ 5000/rates }}</span></div>
                            <div class="col-6 amount_item" @click="amount = 10000"><span>{{ 10000/rates }}</span></div>
                            <div class="col-6 amount_item" @click="amount = 20000"><span>{{ 20000/rates }}</span></div>
                            <div class="col-6 amount_item" @click="amount = 25000"><span>{{ 25000/rates }}</span></div>

                        </div>


                        <button class="btn btn-info" @click="nextFun(2)">Next</button>


<p style="color: red;text-align: center;
font-size: 17px;">রিচার্জ সময় সপ্তাহের সকল দিন সকাল ১০:০০ থেকে রাত ১১ঃ০০ টা পর্যন্ত </p>
                    </div>

                    <form @submit.stop.prevent="onSubmit" v-else-if="step == 2">




    <h4 class="d-block bg-success text-white p-1 my-3">Payment Info</h4>

<p style="color: red;
font-size: 17px;">বিঃদ্রঃ অবশই সেন্ড মানি করবেন এবং রেফারেন্স এ আপনার Username দিবেন ।</p>
    <div class="patment_info">
        <ul class="list-unstyled">


            <li class="li"><span>{{ form.method }} Account</span><span>
                {{ copyMessage }}  <i @click="copyref" class="far fa-copy"></i>

                <br>
                <img style="width:200px; height: 200px !important;"  v-if="form.method=='USDT (TRC-20)'" :src="$asseturl+'frontend/img/qrcode.jpeg'" alt="">





            </span></li>




            <li class="li"  v-if="form.method=='USDT'"><span>Amount</span><span>{{ amount }} USD = {{ amount*rates }} BDT</span></li>
            <li class="li" v-else><span>Amount</span><span>{{ amount*rates }} BDT</span></li>

        </ul>

    </div>
    <h4 class="d-block bg-success text-white p-1 my-3">Recharge Info</h4>


                        <div class="form-group" v-if="form.method=='USDT'">
                            <label for="">Screenshot</label>
                              <input class="form-control form-control-lg" id="formFileLg" @change="FileSelected($event, 'screenshot')" type="file" >
                              <img class="img-thumbnail" :src="form.screenshot" alt="">
                        </div>

                        <div class="form-group">
                            <label for="">Sender Number</label>
                            <input type="tel" class="form-control" v-model="form.sender" required >
                        </div>

                        <div class="form-group mb-3">
                            <label for="">Transition Id</label>
                            <input type="text" class="form-control" v-model="form.trx" required>
                        </div>


                        <button class="btn btn-secondary" @click="nextFun(1)">Previous</button>
                        <button class="btn btn-info" type="button" disabled v-if="con">Wait...</button>
                        <button class="btn btn-info" type="submit" v-else>Submit</button>

                    </form>

                </div>
            </div>
        </section>


                <div class="copyPopup" v-if="popup">
                    <span> Number copied success</span>
                </div>


                 -->

    </div>
</template>

<script>
export default {
    data() {
        return {
               popup:false,
            form: {
                method: '',
                amount: '',
                sender: '',
                screenshot: '',
                trx: '',
            },
            row: {},
            payMethods: '',
            amount: 0,
            step: 1,
            copyMessage:'',
            rates:'',
            con:false,
        }
    },
    methods: {

        async getMethods(){
            var res = await this.callApi('get',`/api/admin/withdraw/gateway/${this.payMethods}`,[]);
            // console.log(res);
            this.copyMessage = res.data.number;
            this.form.method = res.data.name;
            this.rates = res.data.rate;
        },
        copyref() {


            navigator.clipboard.writeText(this.copyMessage);
          this.popup = true

            setTimeout(() => {
                this.popup = false
            }, 1000);
        },


        FileSelected($event, parent_index) {
            let file = $event.target.files[0];
            if (file.size > 5048576) {
                Notification.image_validation();
            } else {
                let reader = new FileReader;
                reader.onload = event => {
                    this.form[parent_index] = event.target.result
                    // console.log(event.target.result);
                };
                reader.readAsDataURL(file)
            }
            //   console.log($event.target.result);
        },

        async getData() {
            var res = await this.callApi('get', `/api/admin/withdraw/gateway`, []);
            this.row = res.data;

        },
        nextFun(step) {
            if (step == 2) {
                if (!this.form.method) {

                    Notification.customError('Method is required');
                } else {
                    if (!this.amount) {
                        Notification.customError('Amount is required');
                    } else {

                        this.step = step;

                            // if(this.form.method=='USDT (TRC-20)'){
                            //     this.copyMessage = 'TAKzYXeRP1PTbYHJrqcfXYe79NokJQ4CMd'
                            // }else{
                            //     this.copyMessage = '01964603334'
                            // }

                    }
                }
            }else{
                 this.step = step;
            }
        },
        async onSubmit(){
            this.con = true

            this.form.amount = this.amount*this.rates;
            // console.log(this.form.amount)

            var id = localStorage.getItem('userid');
            this.form['user_id'] = id;

            var res = await this.callApi('post',`/api/admin/deposit`,this.form);

                    Notification.customSuccess(`Recharge Successfuly Complete`);
                    this.$router.push({ name: 'WithdrawHistory' });



        }

    },
    mounted() {
        this.getData();

    },
}
</script>
<style>
.mainitem {
    display: flex !important;
    flex-direction: row;
    flex-wrap: wrap;
    justify-content: space-between;
}

select.form-control,input.form-control {
    border-bottom: 1px solid #929292;
    height: 2em;
}

select.form-control:focus,input.form-control:focus {
    outline: none;
}

.copyPopup{
    position:fixed !important;
}

</style>
